<?xml version="1.0" encoding="UTF-8"?>
<databaseChangeLog
        xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog
		https://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-4.9.1.xsd">

    <changeSet id="product" author="dinar">
        <sql>
            create table users
            (
                id                 bigserial    not null primary key,
                username           varchar(255) not null,
                enabled            boolean default true,
                encrypted_password text         not null
            );
        </sql>
        <sql>
            alter table users
                add constraint USERS_UK unique (username);
        </sql>
        <sql>
            create table roles
            (
                id        bigserial    not null primary key,
                role_name varchar(255) not null
            );
        </sql>
        <sql>
            alter table roles
                add constraint ROLES_UK unique (role_name);
        </sql>
        <sql>
            create table users_roles
            (
                user_id bigint not null,
                role_id bigint not null,
                foreign key (user_id) references users (id),
                foreign key (role_id) references roles (id)
            );
        </sql>
        <sql>
            alter table users_roles
                add constraint unique (user_id, role_id);
        </sql>
    </changeSet>


</databaseChangeLog>